var DevExpress;!function(o){var t;!function(o){var t=function(){function t(t){var e=this;this._dashboardControl=t,this.name="custom-dashboard-panel",this._customTemplate={name:"dx-dashboard-custom-working-mode-extension",data:this},this.panelWidth=250,this.visible=ko.observable(!1),this.allowSwitchToDesigner=ko.observable(!0),this.selectedItemKeys=ko.observableArray(),this.availableDashboards=ko.observableArray(),this.showPanelAsync=function(o){var t=$.Deferred();return e.visible(!0),setTimeout(function(){o.surfaceLeft=e.panelWidth,t.resolve(o)},500),t.promise()},this.hidePanelAsync=function(o){var t=$.Deferred();return e.visible(!1),setTimeout(function(){o.surfaceLeft=0,t.resolve(o)},500),t.promise()},this.switchToViewer=function(){e._dashboardControl.switchToViewer(),e.updateDashboardsList()},this.switchToDesigner=function(){e._dashboardControl.switchToDesigner()},this._toolbarElement=new o.DashboardToolbarGroup("viewer-button","",100);var s=new o.DashboardToolbarItem("toviewer",function(){return e.switchToViewer()});s.template="dx-dashboard-custom-working-mode-extension-viewer-button",s.disabled=ko.pureComputed(function(){return!!e._dashboardControl.dashboard()}),this.allowSwitchToDesigner("ViewerOnly"!==t.params.workingMode),this._toolbarElement.items.push(s),this.desingerToViewerAction={orderNo:60,action:this.showPanelAsync},this.viewerToDesignerAction={orderNo:20,action:this.hidePanelAsync},this._dashboardControl.isDesignMode()||this._dashboardControl.surfaceLeft(this.panelWidth),this.visible(!this._dashboardControl.isDesignMode()),this.selectedItemKeys.subscribe(function(o){if(o.length){var t=o[0];e._dashboardControl.dashboardContainer()&&e._dashboardControl.dashboardContainer().id!=t&&e._dashboardControl.dashboardServiceClient.loadDashboard(t)}}),this._dashboardControl.dashboardContainer.subscribe(function(o){o&&e._validateSelection(o,e.availableDashboards())}),this.availableDashboards.subscribe(function(o){return e._validateSelection(e._dashboardControl.dashboardContainer(),o)}),this.left=ko.computed(function(){return e.visible()?0:-e.panelWidth})}return t.prototype.start=function(){this._dashboardControl.customTemplates.push(this._customTemplate);var o=this._dashboardControl.findExtension("toolbox");o&&o.toolbarGroups.push(this._toolbarElement),this.updateDashboardsList()},t.prototype.stop=function(){var o=this._dashboardControl.findExtension("toolbox");o&&o.toolbarGroups.remove(this._toolbarElement),this._dashboardControl.customTemplates.remove(this._customTemplate)},t.prototype.updateDashboardsList=function(){var o=this;this._dashboardControl.dashboardContainer();this._dashboardControl.dashboardServiceClient.requestDashboardList().done(function(t){o.availableDashboards(t)})},t.prototype._validateSelection=function(o,t){if(o){var e=t.filter(function(t){return t.id===o.id})[0];e&&this.selectedItemKeys([e.id])}},t}();o.CustomDashboardPanelExtension=t}(t=o.Dashboard||(o.Dashboard={}))}(DevExpress||(DevExpress={}));