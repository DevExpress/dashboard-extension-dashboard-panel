var DevExpress;!function(o){var e;!function(o){var e=function(){function e(e){var t=this;this._dashboardControl=e,this.name="dashboard-panel",this._customTemplate={name:"dx-dashboard-working-mode-extension",data:this},this.panelWidth=250,this.visible=ko.observable(!1),this.allowSwitchToDesigner=ko.observable(!0),this.selectedItemKeys=ko.observableArray(),this.availableDashboards=ko.observableArray(),this.showPanelAsync=function(o){var e=$.Deferred();return t.visible(!0),setTimeout(function(){o.surfaceLeft=t.panelWidth,e.resolve(o)},500),e.promise()},this.hidePanelAsync=function(o){var e=$.Deferred();return t.visible(!1),setTimeout(function(){o.surfaceLeft=0,e.resolve(o)},500),e.promise()},this.switchToViewer=function(){t._dashboardControl.switchToViewer(),t.updateDashboardsList()},this.switchToDesigner=function(){t._dashboardControl.switchToDesigner()},this._toolbarElement=new o.DashboardToolbarGroup("viewer-button","",100);var s=new o.DashboardToolbarItem("toviewer",function(){return t.switchToViewer()});s.template="dx-dashboard-working-mode-extension-viewer-button",s.disabled=ko.pureComputed(function(){return!!t._dashboardControl.dashboard()}),this.allowSwitchToDesigner("ViewerOnly"!==e.params.workingMode),this._toolbarElement.items.push(s),this.desingerToViewerAction={orderNo:60,action:this.showPanelAsync},this.viewerToDesignerAction={orderNo:20,action:this.hidePanelAsync},this._dashboardControl.isDesignMode()||this._dashboardControl.surfaceLeft(this.panelWidth),this.visible(!this._dashboardControl.isDesignMode()),this.selectedItemKeys.subscribe(function(o){if(o.length){var e=o[0];t._dashboardControl.dashboardContainer()&&t._dashboardControl.dashboardContainer().id!=e&&t._dashboardControl.dashboardServiceClient.loadDashboard(e)}}),this._dashboardControl.dashboardContainer.subscribe(function(o){o&&t._validateSelection(o,t.availableDashboards())}),this.availableDashboards.subscribe(function(o){return t._validateSelection(t._dashboardControl.dashboardContainer(),o)}),this.left=ko.computed(function(){return t.visible()?0:-t.panelWidth})}return e.prototype.start=function(){this._dashboardControl.customTemplates.push(this._customTemplate);var o=this._dashboardControl.findExtension("toolbox");o&&o.toolbarGroups.push(this._toolbarElement),this.updateDashboardsList()},e.prototype.stop=function(){var o=this._dashboardControl.findExtension("toolbox");o&&o.toolbarGroups.remove(this._toolbarElement),this._dashboardControl.customTemplates.remove(this._customTemplate)},e.prototype.updateDashboardsList=function(){var o=this;this._dashboardControl.dashboardContainer();this._dashboardControl.dashboardServiceClient.requestDashboardList().done(function(e){o.availableDashboards(e)})},e.prototype._validateSelection=function(o,e){if(o){var t=e.filter(function(e){return e.id===o.id})[0];t&&this.selectedItemKeys([t.id])}},e}();o.DashboardPanelExtension=e}(e=o.Dashboard||(o.Dashboard={}))}(DevExpress||(DevExpress={}));